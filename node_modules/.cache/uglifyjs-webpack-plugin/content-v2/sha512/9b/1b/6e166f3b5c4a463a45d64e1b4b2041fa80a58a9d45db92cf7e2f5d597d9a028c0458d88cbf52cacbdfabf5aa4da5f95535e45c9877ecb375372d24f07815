{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[\"chunk-19ca\"],{\"+8W6\":function(t,e,s){\"use strict\";var i=s(\"YaZL\");s.n(i).a},\"0Qur\":function(t,e,s){\"use strict\";s.r(e);var i={data:function(){return{remarks:\"同意\",stepId:\"\",procInstId:\"\",stepName:\"\",noNextFlag:!1,dealListInfo:{},loadFlag:!1,toBackPage:\"\",toDealList:\"\",ctProcStepRel:{},assignees:[],nextStep:\"-1\",audiLevel:\"-1\",levelId:\"\"}},mounted:function(){window.addEventListener(\"popstate\",this.back,!1),this.dealListInfo=this.$route.params.dealListInfo,this.toBackPage=this.$route.params.pageName,this.toDealList=\"activityToDo\",\"2\"===this.dealListInfo.stepId||\"4\"===this.dealListInfo.stepId?this.getActivityLevelId():this.getActivityNextStep()},methods:{back:function(){window.removeEventListener(\"popstate\",this.back,!1),this.$router.push({name:this.toBackPage})},goDealList:function(){window.removeEventListener(\"popstate\",this.back,!1),this.$store.commit(\"pageInfo/clear\",this.$data),this.$router.push({name:this.toDealList})},getActivityLevelId:function(){var t=this,e={orgId:this.dealListInfo.regionCode},s=this.$api.getActivityLevelId;this.$http.getJson(s,e).then(function(e){e.RETURN_CODE;var s=e.OUT_DATA;\"0\"==e.RETURN_CODE?(t.loadFlag=!1,t.levelId=s,t.getActivityNextStep()):(t.loadFlag=!1,t.$tip.error(\"政企活动审批分公司等级查询错误\"))}).catch(function(e){t.loadFlag=!1})},getActivityNextStep:function(){var t=this;this.loadFlag=!0;var e;e=\"1\"===this.levelId?50:\"2\"===this.levelId?30:20;var s=[{key:\"isPass_\"+this.dealListInfo.stepId,value:\"1\"}];if(\"2\"===this.dealListInfo.stepId?\"0\"===this.dealListInfo.type?this.audiLevel=\"1\":\"1\"===this.dealListInfo.type&&this.dealListInfo.budgetMoney>1e4*e&&(this.audiLevel=\"1\"):\"4\"===this.dealListInfo.stepId&&(\"0\"===this.dealListInfo.type?this.audiLevel=\"0\":this.audiLevel=\"1\"),\"-1\"!==this.audiLevel){var i={key:\"audiLevel\",value:this.audiLevel};s.push(i)}var a={paramsList:s,ctTaskInstInfo:{stepId:this.dealListInfo.stepId,procInstId:this.dealListInfo.procInstId}},n=this.$api.getActivityNextStep;this.$http.postJson(n,a).then(function(e){e.RETURN_CODE;var s=e.OUT_DATA;\"0\"==e.RETURN_CODE?(t.loadFlag=!1,t.ctProcStepRel=s.ctProcStepRel,t.assignees=s.assignees,(void 0==s.assignees||s.assignees.length<1)&&(t.noNextFlag=!0)):(t.loadFlag=!1,t.$tip.error(\"政企活动审批待办查询接口返回信息错误\"))}).catch(function(e){t.loadFlag=!1})},submitCheck:function(){if(!this.noNextFlag){if(this.loadFlag)return;if(\"-1\"==this.nextStep)return void this.$tip.warn(\"请选择下一环节处理人\");if(\"\"==this.remarks)return void this.$tip.warn(\"请填写意见备注\")}this.loadFlag=!0,this.submitTask()},submitTask:function(){var t=this;this.loadFlag=!0;var e=[{key:\"isPass_\"+this.dealListInfo.stepId,value:\"1\"},{key:\"ASSIGNEE_\"+this.ctProcStepRel.stepId,value:this.nextStep}];if(\"-1\"!==this.audiLevel){var s={key:\"audiLevel\",value:this.audiLevel};e.push(s)}var i={taskInDto:{ctTaskInstInfo:{stepId:this.dealListInfo.stepId,procInstId:this.dealListInfo.procInstId,stepName:this.dealListInfo.stepName,taskInstId:this.dealListInfo.taskInstId,dealOpinion:\"同意\",remarks:this.remarks},paramsList:e},activityInfoDTO:this.dealListInfo},a=this.$api.submitActivityTask;this.$http.postJson(a,i).then(function(e){e.RETURN_CODE,e.OUT_DATA,\"0\"==e.RETURN_CODE?(t.$tip.success(\"审批成功\"),setTimeout(t.goDealList,2e3),t.loadFlag=!1):(t.$tip.error(\"政企活动审批接口返回信息错误\"),t.loadFlag=!1)}).catch(function(e){t.loadFlag=!1})}}},a=(s(\"+8W6\"),s(\"47Ln\"),s(\"KHd+\")),n=Object(a.a)(i,function(){var t=this,e=t.$createElement,s=t._self._c||e;return s(\"div\",{attrs:{id:\"memberAgree\"}},[s(\"body\",{staticClass:\"body-pdt\"},[s(\"header\",{staticClass:\"header-sub\"},[s(\"a\",{staticClass:\"el-icon-arrow-left\",on:{click:t.back}}),t._v(\" \"),s(\"h2\",{staticClass:\"font-32 color-white text-center\"},[t._v(\"确认同意\")])]),t._v(\" \"),s(\"section\",[t._m(0),t._v(\" \"),s(\"div\",{staticClass:\"panel-body\"},[s(\"div\",{staticClass:\"pl-box\"},[s(\"div\",{staticClass:\"pl-box-body pd-big\"},[s(\"el-input\",{attrs:{type:\"textarea\",autosize:{minRows:15,maxRows:15},placeholder:\"请输入处理意见\",resize:\"none\"},model:{value:t.remarks,callback:function(e){t.remarks=e},expression:\"remarks\"}})],1)])]),t._v(\" \"),t.noNextFlag?t._e():s(\"div\",{staticClass:\"cq-panel mgt-md\"},[s(\"div\",{staticClass:\"cq-panel\"},[s(\"div\",{staticClass:\"panel-head\"},[s(\"h3\",{staticStyle:{width:\"100%\"}},[t._v(\"下一环节\"),s(\"span\",{staticStyle:{\"padding-right\":\"0.32rem\",float:\"right\"}},[t._v(t._s(t.ctProcStepRel.stepName))])])])]),t._v(\" \"),s(\"div\",{staticClass:\"panel-body pdl-big pdr-big\"},[s(\"div\",{staticClass:\"cq-cell\"},[s(\"span\",{staticClass:\"name cq-req\"},[t._v(\"下一环节处理人\")]),t._v(\" \"),s(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:!t.noNextFlag,expression:\"!noNextFlag\"}],staticClass:\"cell-main\",staticStyle:{\"padding-right\":\"0.32rem\"}},[s(\"select\",{directives:[{name:\"model\",rawName:\"v-model\",value:t.nextStep,expression:\"nextStep\"}],staticClass:\"cq-select cq-select-block\",on:{change:function(e){var s=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return\"_value\"in t?t._value:t.value});t.nextStep=e.target.multiple?s:s[0]}}},[s(\"option\",{attrs:{value:\"-1\",selected:\"selected\"}},[t._v(\"请选择\")]),t._v(\" \"),t._l(t.assignees,function(e){return s(\"option\",{key:e.assignee,domProps:{value:e.assignee}},[t._v(t._s(e.assigneeName)+\"\\n                \")])})],2)]),t._v(\" \"),s(\"div\",{directives:[{name:\"show\",rawName:\"v-show\",value:t.noNextFlag,expression:\"noNextFlag\"}],staticClass:\"cell-main\",staticStyle:{\"padding-right\":\"0.32rem\"}},[s(\"span\",{staticStyle:{color:\"red\"}},[t._v(\"请联系管理员进行角色配置\")])])])])])]),t._v(\" \"),s(\"div\",{staticClass:\"pdl-huge pdr-huge pdt-big pdb-big flex\"},[s(\"button\",{staticClass:\"cq-btn cq-btn-block cq-btn-big\",on:{click:t.submitCheck}},[t.loadFlag?s(\"i\",{staticClass:\"el-icon-loading\"}):t._e(),t._v(\" \"),t.loadFlag?t._e():s(\"span\",{staticStyle:{\"font-size\":\"0.36rem\"}},[t._v(\"确认同意\")])])])])])},[function(){var t=this.$createElement,e=this._self._c||t;return e(\"div\",{staticClass:\"cq-panel\"},[e(\"div\",{staticClass:\"panel-head\"},[e(\"h3\",[this._v(\"审批意见\")])])])}],!1,null,\"37d77334\",null);n.options.__file=\"activityAgree.vue\",e.default=n.exports},\"47Ln\":function(t,e,s){\"use strict\";var i=s(\"LBCI\");s.n(i).a},LBCI:function(t,e,s){},YaZL:function(t,e,s){}}]);","extractedComments":[]}